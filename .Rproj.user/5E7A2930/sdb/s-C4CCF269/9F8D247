{
    "collab_server" : "",
    "contents" : "library(rvest)\nlibrary(lubridate)\nPaginas <- c(100:808)\nPaginas <- Paginas[-59]\nPaginas <- Paginas[-147]\nPaginas <- Paginas[-170]\nPaginas <- Paginas[-206]\nPaginas <- Paginas[-471]\n\n\n\nFechas <- list()\nNiveles <- list()\n\nfor (i in 1:length(Paginas)){\n  Polen <- read_html(paste0(\"http://www.polenes.cl/sitio/santiago.asp?idgraph=\", Paginas[i]))\n  Fecha <-Polen %>% html_nodes(\"span\") %>% html_text()\n  Fechas[[i]] <- sub(\".*Periodo: *(.*?) *hasta*\", \"\\\\1\", Fecha)\n  Nivel <- Polen %>% html_nodes(\"td\") %>% html_text()  \n  Niveles[[i]] <- as.numeric(gsub(\"[^0-9]\", \"\", Nivel[11:13], \"\"))\n  print(i)\n}\n\n\nFechas <- do.call(rbind, Fechas)\nFechas <- as.data.frame(Fechas)\ncolnames(Fechas) <- c(\"Fechas\")\n\nNiveles <- as.data.frame(do.call(rbind, Niveles))\ncolnames(Niveles) <- c(\"arboles_total\", \"platano_oriental\", \"pastos\")\n\nAlergia <- cbind(Fechas, Niveles)\nAlergia$Fechas <- as.character(Alergia$Fechas)\nAlergia$Fechas <-str_match(Alergia$Fechas, \"Período:(.*?) hasta\")[,2]\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Enero de \", \"1-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Febrero de \", \"2-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Marzo de \", \"3-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Abril de \", \"4-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Mayo de \", \"5-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Junio de \", \"6-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Julio de \", \"7-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Agosto de \", \"8-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Septiembre de \", \"9-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Octubre de \", \"10-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Noviembre de \", \"11-\")\nAlergia$Fechas <- str_replace(Alergia$Fechas, \"Diciembre de \", \"12-\")\n\n\nAlergia$Fechas <- dmy(Alergia$Fechas)\n\nAlergia$Anno <- year(Alergia$Fechas)\nAlergia$Mes <- month(Alergia$Fechas)\nAlergia$Semana <- week(Alergia$Fechas)\nAlergia <- dplyr::filter(Alergia, Anno > 2000)\n\nsaveRDS(Alergia, \"Alergia.rds\")\n\n\nlibrary(ggplot2)\nlibrary(dplyr)\n\nggplot(Alergia, aes(x = Fechas, y = platano_oriental)) + geom_area() + theme_classic()\n\n\nWeekly <- Alergia %>% select(Semana, platano_oriental) %>%group_by(Semana) %>% summarise_all(funs(mean, sd, max, min))\n\n\nggplot(Weekly, aes(x = Semana, y = mean))+  geom_ribbon(aes(ymax = max, ymin = min, fill = \"red\")) + geom_ribbon(aes(ymax = mean + sd, ymin = mean - sd, fill = \"blue\"), alpha = 1) + geom_line() + scale_fill_manual(name = \"leyenda\", values = c(\"blue\", \"red\"), labels = c('Error estándar','Extremos')) + ylab(\"polen de platano oriental /m³ de aire\") + theme(legend.position=\"bottom\") + theme_classic()\n\n\n",
    "created" : 1507991695793.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2386741670",
    "id" : "9F8D247",
    "lastKnownWriteTime" : 1508011320,
    "last_content_update" : 1508011320085,
    "path" : "~/Documents/Polen/Polenes.R",
    "project_path" : "Polenes.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}